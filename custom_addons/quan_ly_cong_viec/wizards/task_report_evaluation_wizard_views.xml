<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- ============================================================ -->
    <!-- Wizard ƒê√°nh Gi√° B√°o C√°o AI (Cho Supervisor) -->
    <!-- ============================================================ -->
    
    <record id="view_task_report_evaluation_wizard_form" model="ir.ui.view">
        <field name="name">task.report.evaluation.wizard.form</field>
        <field name="model">task.report.evaluation.wizard</field>
        <field name="arch" type="xml">
            <form string="ü§ñ ƒê√°nh Gi√° B√°o C√°o B·∫±ng AI">
                <header>
                    <button name="action_evaluate_with_ai" 
                            string="ü§ñ ƒê√°nh Gi√° B·∫±ng AI" 
                            type="object" 
                            class="oe_highlight"
                            attrs="{'invisible': [('evaluation_done', '=', True)]}"/>
                    <button name="action_save_and_apply" 
                            string="‚úÖ L∆∞u &amp; √Åp D·ª•ng" 
                            type="object" 
                            class="oe_highlight"
                            attrs="{'invisible': [('evaluation_done', '=', False)]}"/>
                    <button string="H·ªßy" special="cancel"/>
                </header>
                
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="task_name" readonly="1"/>
                        </h1>
                    </div>
                    
                    <group>
                        <group string="üìã Y√™u C·∫ßu Ban ƒê·∫ßu">
                            <field name="task_requirement" readonly="1" nolabel="1"/>
                        </group>
                    </group>
                    
                    <field name="evaluation_done" invisible="1"/>
                    
                    <notebook>
                        <page string="üìù B√°o C√°o K·∫øt Qu·∫£" name="report">
                            <group>
                                <group>
                                    <field name="result_note" nolabel="1" 
                                           placeholder="M√¥ t·∫£ chi ti·∫øt c√¥ng vi·ªác ƒë√£ l√†m..."/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="üìé File B√°o C√°o">
                                    <field name="result_file_ids" nolabel="1" widget="many2many_binary"/>
                                </group>
                                <group string="‚è±Ô∏è Th·ªùi Gian">
                                    <field name="actual_hours"/>
                                </group>
                            </group>
                        </page>
                        
                        <page string="ü§ñ K·∫øt Qu·∫£ ƒê√°nh Gi√° AI" name="evaluation" 
                              attrs="{'invisible': [('evaluation_done', '=', False)]}">
                            <group>
                                <group string="üìä ƒêi·ªÉm S·ªë">
                                    <field name="ai_overall_completion" widget="percentage"/>
                                    <field name="ai_grade" widget="badge"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="‚úÖ ƒê√£ Ho√†n Th√†nh">
                                    <field name="ai_completed_items" nolabel="1"/>
                                </group>
                                <group string="‚ùå Ch∆∞a Ho√†n Th√†nh">
                                    <field name="ai_incomplete_items" nolabel="1"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="‚≠ê L√†m V∆∞·ª£t M·ª©c">
                                    <field name="ai_exceeded_items" nolabel="1"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="üìù Ph√¢n T√≠ch Chi Ti·∫øt">
                                    <field name="ai_detailed_analysis" nolabel="1"/>
                                </group>
                                <group string="üí° Khuy·∫øn Ngh·ªã">
                                    <field name="ai_recommendations" nolabel="1"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>
    
    <record id="action_task_report_evaluation_wizard" model="ir.actions.act_window">
        <field name="name">ü§ñ ƒê√°nh Gi√° B√°o C√°o AI</field>
        <field name="res_model">task.report.evaluation.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="model_cong_viec"/>
        <field name="binding_view_types">form</field>
    </record>
    
    
    <!-- ============================================================ -->
    <!-- Wizard N·ªôp B√°o C√°o (Cho Nh√¢n Vi√™n) -->
    <!-- ============================================================ -->
    
    <record id="view_task_submit_report_wizard_form" model="ir.ui.view">
        <field name="name">task.submit.report.wizard.form</field>
        <field name="model">task.submit.report.wizard</field>
        <field name="arch" type="xml">
            <form string="üì§ N·ªôp B√°o C√°o C√¥ng Vi·ªác">
                <header>
                    <button name="action_submit_report" 
                            string="üì§ N·ªôp B√°o C√°o" 
                            type="object" 
                            class="oe_highlight"/>
                    <button string="H·ªßy" special="cancel"/>
                </header>
                
                <sheet>
                    <div class="alert alert-info" role="alert">
                        <strong>üí° H∆∞·ªõng d·∫´n:</strong> H√£y m√¥ t·∫£ chi ti·∫øt nh·ªØng g√¨ b·∫°n ƒë√£ l√†m, 
                        k·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c, v√† c√°c v·∫•n ƒë·ªÅ g·∫∑p ph·∫£i (n·∫øu c√≥). 
                        ƒê√≠nh k√®m file b√°o c√°o ƒë·ªÉ ng∆∞·ªùi gi√°m s√°t c√≥ th·ªÉ ƒë√°nh gi√° ch√≠nh x√°c h∆°n.
                    </div>
                    
                    <group>
                        <group>
                            <field name="task_id" invisible="1"/>
                        </group>
                    </group>
                    
                    <group>
                        <group string="üìù B√°o C√°o K·∫øt Qu·∫£">
                            <field name="result_note" nolabel="1" 
                                   placeholder="M√¥ t·∫£ chi ti·∫øt c√¥ng vi·ªác ƒë√£ l√†m: &#10;&#10;1. Nh·ªØng g√¨ ƒë√£ ho√†n th√†nh:&#10;   - ...&#10;&#10;2. K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c:&#10;   - ...&#10;&#10;3. V·∫•n ƒë·ªÅ g·∫∑p ph·∫£i (n·∫øu c√≥):&#10;   - ..."/>
                        </group>
                    </group>
                    
                    <group>
                        <group string="üìé File K·∫øt Qu·∫£">
                            <field name="result_file_ids" nolabel="1" widget="many2many_binary"/>
                            <p class="text-muted">
                                <i class="fa fa-info-circle"/> H·ªó tr·ª£: Word, PDF, Excel, ZIP, h√¨nh ·∫£nh, v.v.
                            </p>
                        </group>
                        <group string="‚è±Ô∏è Th·ªùi Gian">
                            <field name="actual_hours" widget="float_time"/>
                            <p class="text-muted">
                                <i class="fa fa-clock-o"/> T·ªïng s·ªë gi·ªù th·ª±c t·∫ø ƒë√£ l√†m
                            </p>
                        </group>
                    </group>
                    
                    <group>
                        <group>
                            <field name="submit_for_review"/>
                            <p class="text-muted" attrs="{'invisible': [('submit_for_review', '=', False)]}">
                                <i class="fa fa-check"/> C√¥ng vi·ªác s·∫Ω chuy·ªÉn sang tr·∫°ng th√°i "Ch·ªù duy·ªát"
                            </p>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>
    
    <record id="action_task_submit_report_wizard" model="ir.actions.act_window">
        <field name="name">üì§ N·ªôp B√°o C√°o</field>
        <field name="res_model">task.submit.report.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="model_cong_viec"/>
        <field name="binding_view_types">form</field>
    </record>

</odoo>
