<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Tree View -->
        <record id="view_nhan_su_tree" model="ir.ui.view">
            <field name="name">nhan.su.tree</field>
            <field name="model">nhan.su</field>
            <field name="arch" type="xml">
                <tree string="NhÃ¢n viÃªn" sample="1"
                      decoration-success="working_status=='working'"
                      decoration-warning="working_status=='probation'"
                      decoration-danger="working_status in ['resigned','terminated']"
                      decoration-muted="working_status=='retired'">
                    <field name="employee_code"/>
                    <field name="avatar" widget="image" options="{'size': [40, 40]}"/>
                    <field name="name"/>
                    <field name="department_id"/>
                    <field name="job_position"/>
                    <field name="job_level"/>
                    <field name="manager_id"/>
                    <field name="working_status" widget="badge"
                           decoration-success="working_status=='working'"
                           decoration-warning="working_status=='probation'"/>
                    <field name="ai_performance_score" widget="progressbar"
                           decoration-danger="ai_performance_score &lt; 60"
                           decoration-warning="ai_performance_score &lt; 75"
                           decoration-success="ai_performance_score &gt;= 75"/>
                    <field name="ai_performance_level" optional="hide"/>
                    <field name="join_date"/>
                    <field name="phone"/>
                    <field name="work_email"/>
                    <field name="base_salary" optional="hide"/>
                </tree>
            </field>
        </record>
        
        <!-- Form View -->
        <record id="view_nhan_su_form" model="ir.ui.view">
            <field name="name">nhan.su.form</field>
            <field name="model">nhan.su</field>
            <field name="arch" type="xml">
                <form string="NhÃ¢n viÃªn">
                    <header>
                        <button name="action_set_working" string="Chuyá»ƒn Äang lÃ m viá»‡c"
                                type="object" class="oe_highlight"
                                attrs="{'invisible': [('working_status', 'not in', ['draft', 'probation'])]}"/>
                        <button name="action_resign" string="Nghá»‰ viá»‡c"
                                type="object"
                                confirm="Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xá»­ lÃ½ nghá»‰ viá»‡c cho nhÃ¢n viÃªn nÃ y?"
                                attrs="{'invisible': [('working_status', 'not in', ['working', 'on_leave'])]}"/>
                        <button name="action_ai_evaluate_detailed" string="ðŸ¤– ÄÃ¡nh giÃ¡ AI chi tiáº¿t"
                                type="object" class="oe_highlight"
                                attrs="{'invisible': [('total_tasks', '=', 0)]}"/>
                        <button name="action_evaluate_performance" string="ÄÃ¡nh giÃ¡ hiá»‡u suáº¥t"
                                type="object" class="oe_highlight"
                                attrs="{'invisible': [('working_status', '!=', 'working')]}"/>
                        <field name="working_status" widget="statusbar"
                               statusbar_visible="draft,probation,working"/>
                    </header>
                    
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="action_view_tasks" type="object"
                                    class="oe_stat_button" icon="fa-tasks">
                                <div class="o_field_widget o_stat_info">
                                    <span class="o_stat_value">
                                        <field name="total_tasks"/>
                                    </span>
                                    <span class="o_stat_text">CÃ´ng viá»‡c</span>
                                </div>
                            </button>
                            <button name="action_view_performance_history" type="object"
                                    class="oe_stat_button" icon="fa-line-chart">
                                <field name="performance_history_count" widget="statinfo" string="ÄÃ¡nh giÃ¡"/>
                            </button>
                        </div>
                        
                        <widget name="web_ribbon" title="ÄÃ£ nghá»‰ viá»‡c" bg_color="bg-danger"
                                attrs="{'invisible': [('working_status', 'not in', ['resigned', 'retired', 'terminated'])]}"/>
                        
                        <field name="avatar" widget="image" class="oe_avatar"
                               options="{'size': [150, 150]}"/>
                        
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1>
                                <field name="name" placeholder="Há» vÃ  tÃªn nhÃ¢n viÃªn"/>
                            </h1>
                            <h3>
                                <field name="job_position" placeholder="Vá»‹ trÃ­ cÃ´ng viá»‡c"/>
                                <span> - </span>
                                <field name="department_id" placeholder="PhÃ²ng ban"/>
                            </h3>
                        </div>
                        
                        <group>
                            <group string="ThÃ´ng tin cÆ¡ báº£n">
                                <field name="employee_code" readonly="1"/>
                                <field name="gender"/>
                                <field name="date_of_birth"/>
                                <field name="age"/>
                                <field name="retirement_age_check" widget="boolean_toggle"/>
                            </group>
                            <group string="LiÃªn há»‡">
                                <field name="phone" widget="phone"/>
                                <field name="work_email" widget="email"/>
                                <field name="personal_email" widget="email"/>
                            </group>
                        </group>
                        
                        <notebook>
                            <!-- Tab 1: ThÃ´ng tin cÃ¡ nhÃ¢n -->
                            <page string="ThÃ´ng tin cÃ¡ nhÃ¢n" name="personal_info">
                                <group>
                                    <group string="Äá»‹nh danh">
                                        <field name="identification_type"/>
                                        <field name="identification_number"/>
                                        <field name="identification_issue_date"/>
                                        <field name="identification_issue_place"/>
                                        <field name="identification_expiry_date"/>
                                    </group>
                                    <group string="Gia Ä‘Ã¬nh">
                                        <field name="nationality"/>
                                        <field name="place_of_birth"/>
                                        <field name="marital_status"/>
                                        <field name="number_of_dependents"/>
                                    </group>
                                </group>
                                
                                <group string="Äá»‹a chá»‰">
                                    <group>
                                        <label for="permanent_address" string="Äá»‹a chá»‰ thÆ°á»ng trÃº"/>
                                        <div class="o_address_format">
                                            <field name="permanent_address" placeholder="Äá»‹a chá»‰ cá»¥ thá»ƒ"/>
                                            <field name="permanent_city" placeholder="Tá»‰nh/ThÃ nh phá»‘"/>
                                        </div>
                                    </group>
                                    <group>
                                        <label for="temporary_address" string="Äá»‹a chá»‰ táº¡m trÃº"/>
                                        <div class="o_address_format">
                                            <field name="temporary_address" placeholder="Äá»‹a chá»‰ cá»¥ thá»ƒ"/>
                                            <field name="temporary_city" placeholder="Tá»‰nh/ThÃ nh phá»‘"/>
                                        </div>
                                    </group>
                                </group>
                                
                                <group string="LiÃªn há»‡ kháº©n cáº¥p">
                                    <field name="emergency_contact_name"/>
                                    <field name="emergency_contact_relationship"/>
                                    <field name="emergency_contact_phone" widget="phone"/>
                                </group>
                            </page>
                            
                            <!-- Tab 2: ThÃ´ng tin cÃ´ng viá»‡c -->
                            <page string="ThÃ´ng tin cÃ´ng viá»‡c" name="work_info">
                                <group>
                                    <group string="CÃ´ng viá»‡c hiá»‡n táº¡i">
                                        <field name="department_id"/>
                                        <field name="job_position"/>
                                        <field name="job_level"/>
                                        <field name="manager_id"
                                               domain="[('id', '!=', id), ('working_status', '=', 'working')]"/>
                                        <field name="work_location"/>
                                    </group>
                                    <group string="HÃ¬nh thá»©c lÃ m viá»‡c">
                                        <field name="employment_type"/>
                                        <field name="working_type"/>
                                        <field name="join_date"/>
                                    </group>
                                </group>
                                
                                <group>
                                    <group string="Thá»i gian thá»­ viá»‡c">
                                        <field name="probation_start_date"/>
                                        <field name="probation_end_date"/>
                                        <field name="probation_duration" widget="integer"/>
                                    </group>
                                    <group string="Há»£p Ä‘á»“ng lao Ä‘á»™ng">
                                        <field name="contract_type"/>
                                        <field name="contract_number"/>
                                        <field name="contract_start_date"/>
                                        <field name="contract_end_date"/>
                                    </group>
                                </group>
                                
                                <group string="Tráº¡ng thÃ¡i &amp; Nghá»‰ viá»‡c"
                                       attrs="{'invisible': [('working_status', 'not in', ['resigned', 'terminated'])]}">
                                    <field name="resignation_date"/>
                                    <field name="resignation_reason"/>
                                </group>
                            </page>
                            
                            <!-- Tab 3: LÆ°Æ¡ng & PhÃºc lá»£i -->
                            <page string="LÆ°Æ¡ng &amp; PhÃºc lá»£i" name="salary_benefits"
                                  groups="quan_ly_nhan_su.group_nhan_su_officer">
                                <group>
                                    <group string="LÆ°Æ¡ng cÆ¡ báº£n">
                                        <field name="currency_id" invisible="1"/>
                                        <field name="base_salary" widget="monetary"
                                               options="{'currency_field': 'currency_id'}"/>
                                    </group>
                                    <group string="Phá»¥ cáº¥p">
                                        <field name="position_allowance" widget="monetary"/>
                                        <field name="housing_allowance" widget="monetary"/>
                                        <field name="transportation_allowance" widget="monetary"/>
                                        <field name="phone_allowance" widget="monetary"/>
                                        <field name="meal_allowance" widget="monetary"/>
                                        <field name="other_allowance" widget="monetary"/>
                                    </group>
                                </group>
                                
                                <group>
                                    <group string="Tá»•ng há»£p">
                                        <field name="total_allowance" widget="monetary" readonly="1"/>
                                        <field name="gross_salary" widget="monetary" readonly="1"/>
                                        <field name="insurance_salary" widget="monetary" readonly="1"/>
                                    </group>
                                    <group string="Báº£o hiá»ƒm">
                                        <field name="social_insurance" widget="boolean_toggle"/>
                                        <field name="health_insurance" widget="boolean_toggle"/>
                                        <field name="unemployment_insurance" widget="boolean_toggle"/>
                                        <field name="insurance_number"/>
                                    </group>
                                </group>
                                
                                <group>
                                    <group string="Thuáº¿ TNCN">
                                        <field name="tax_code"/>
                                        <field name="number_of_dependents"/>
                                    </group>
                                    <group string="NgÃ¢n hÃ ng">
                                        <field name="bank_name"/>
                                        <field name="bank_account_number"/>
                                        <field name="bank_branch"/>
                                    </group>
                                </group>
                            </page>
                            
                            <!-- Tab 4: Há»‡ thá»‘ng -->
                            <page string="Há»‡ thá»‘ng &amp; Ghi chÃº" name="system">
                                <group>
                                    <group string="TÃ i khoáº£n">
                                        <field name="user_id" options="{'no_create': True}"/>
                                        <field name="company_id" groups="base.group_multi_company"/>
                                        <field name="active" widget="boolean_toggle"/>
                                    </group>
                                </group>
                                
                                <group string="Ghi chÃº">
                                    <field name="note" nolabel="1" placeholder="Ghi chÃº ná»™i bá»™..."/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    
                    <!-- Chatter -->
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>
        
        <!-- Kanban View -->
        <record id="view_nhan_su_kanban" model="ir.ui.view">
            <field name="name">nhan.su.kanban</field>
            <field name="model">nhan.su</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile" sample="1">
                    <field name="id"/>
                    <field name="employee_code"/>
                    <field name="name"/>
                    <field name="avatar"/>
                    <field name="department_id"/>
                    <field name="job_position"/>
                    <field name="job_level"/>
                    <field name="working_status"/>
                    <field name="ai_performance_score"/>
                    <field name="phone"/>
                    <field name="work_email"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_global_click o_kanban_record_has_image_fill">
                                <div class="o_kanban_image_fill_left d-none d-md-block"
                                     t-attf-style="background-image: url('#{kanban_image('nhan.su', 'avatar', record.id.raw_value)}')"/>
                                
                                <div class="oe_kanban_details">
                                    <div class="o_kanban_record_top">
                                        <div class="o_kanban_record_headings">
                                            <strong class="o_kanban_record_title">
                                                <field name="name"/>
                                            </strong>
                                            <br/>
                                            <span class="text-muted">
                                                <field name="employee_code"/> - <field name="job_position"/>
                                            </span>
                                        </div>
                                        <div class="o_kanban_record_top_right">
                                            <field name="working_status" widget="label_selection"
                                                   options="{'classes': {'working': 'success', 'probation': 'warning', 'resigned': 'danger'}}"/>
                                        </div>
                                    </div>
                                    
                                    <div class="o_kanban_record_body">
                                        <div class="row">
                                            <div class="col-12">
                                                <i class="fa fa-building-o"/> <field name="department_id"/>
                                            </div>
                                        </div>
                                        <div class="row mt-1">
                                            <div class="col-12">
                                                <i class="fa fa-phone"/> <field name="phone"/>
                                            </div>
                                        </div>
                                        <div class="row mt-1">
                                            <div class="col-12">
                                                <i class="fa fa-envelope-o"/> <field name="work_email"/>
                                            </div>
                                        </div>
                                        <div class="row mt-2">
                                            <div class="col-12">
                                                <strong>AI Performance: </strong>
                                                <field name="ai_performance_score" widget="progressbar"/>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        
        <!-- Search View -->
        <record id="view_nhan_su_search" model="ir.ui.view">
            <field name="name">nhan.su.search</field>
            <field name="model">nhan.su</field>
            <field name="arch" type="xml">
                <search string="TÃ¬m kiáº¿m nhÃ¢n viÃªn">
                    <field name="name" string="NhÃ¢n viÃªn"
                           filter_domain="['|', '|', ('name', 'ilike', self), ('employee_code', 'ilike', self), ('work_email', 'ilike', self)]"/>
                    <field name="department_id"/>
                    <field name="manager_id"/>
                    <field name="job_position"/>
                    
                    <filter string="Äang lÃ m viá»‡c" name="working"
                            domain="[('working_status', '=', 'working')]"/>
                    <filter string="Äang thá»­ viá»‡c" name="probation"
                            domain="[('working_status', '=', 'probation')]"/>
                    <filter string="ÄÃ£ nghá»‰ viá»‡c" name="resigned"
                            domain="[('working_status', 'in', ['resigned', 'retired', 'terminated'])]"/>
                    
                    <separator/>
                    <filter string="Hiá»‡u suáº¥t cao" name="high_performance"
                            domain="[('ai_performance_score', '&gt;=', 75)]"/>
                    <filter string="Cáº§n cáº£i thiá»‡n" name="need_improvement"
                            domain="[('ai_performance_score', '&lt;', 60)]"/>
                    
                    <separator/>
                    <filter string="Äá»§ tuá»•i nghá»‰ hÆ°u" name="retirement_age"
                            domain="[('retirement_age_check', '=', True)]"/>
                    
                    <separator/>
                    <filter string="ÄÃ£ lÆ°u trá»¯" name="inactive"
                            domain="[('active', '=', False)]"/>
                    
                    <group expand="0" string="NhÃ³m theo">
                        <filter string="PhÃ²ng ban" name="group_department"
                                context="{'group_by': 'department_id'}"/>
                        <filter string="Cáº¥p báº­c" name="group_level"
                                context="{'group_by': 'job_level'}"/>
                        <filter string="Tráº¡ng thÃ¡i" name="group_status"
                                context="{'group_by': 'working_status'}"/>
                        <filter string="Quáº£n lÃ½" name="group_manager"
                                context="{'group_by': 'manager_id'}"/>
                        <filter string="HÃ¬nh thá»©c" name="group_employment"
                                context="{'group_by': 'employment_type'}"/>
                    </group>
                </search>
            </field>
        </record>
        
        <!-- Action -->
        <record id="action_nhan_su" model="ir.actions.act_window">
            <field name="name">NhÃ¢n viÃªn</field>
            <field name="res_model">nhan.su</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="search_view_id" ref="view_nhan_su_search"/>
            <field name="context">{'search_default_working': 1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Táº¡o há»“ sÆ¡ nhÃ¢n viÃªn má»›i
                </p>
                <p>
                    Quáº£n lÃ½ toÃ n bá»™ thÃ´ng tin nhÃ¢n viÃªn tá»« tuyá»ƒn dá»¥ng Ä‘áº¿n nghá»‰ viá»‡c.
                    Há»‡ thá»‘ng tÃ­ch há»£p AI Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t tá»± Ä‘á»™ng.
                </p>
            </field>
        </record>
        
    </data>
</odoo>
